<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
  <title>Login</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/stylesheets/doctorStyles.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>

<!-- <% include ../partials/nav.ejs %> -->
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
	  <a class="navbar-brand" href="/login">Login</a>
    </div>
  </div>
</nav>  

<script>
function validateForm() {
	var login = document.forms["loginForm"];
    var uname = login["currentUser"].value;
	var psw = login["psw"].value;
	if (uname == "" || psw == "") {
       alert("All fields must be filled out");
	   return false;
	}
	<% docs.forEach(function(doc) { %>
		var doc = <%- JSON.stringify(doc) %>;
		if (doc.user == uname && doc.password == psw && doc.status == "not connected"){
			document.cookie = "user=" + uname;
			document.cookie = "type=" + doc.type;
			document.cookie = "number=" + doc.number;
			document.cookie = "name=" + doc.name;
			if (doc.type == "doctor") {
				document.cookie = "division=" + doc.division;
			}
			return true;
		}
	<% }); %>
	alert("wrong username/password or doctor already connected");
	return false;
}
</script>

<div class="page-header">
	<center><h2> Login <br> </h2></center>
</div>

<div class="imgcontainer">
	<img src="/cas-padlock-icon.png" alt="Login" class="avatar" style="width:128px;height:128px;">
</div>

<div class = "container">
<form name="loginForm" action = "/logged" method = "post" onsubmit="return validateForm()">
	<div class="form-group">
		<label><b>Username</b></label>
		<input type="text" class = "form-control" placeholder="Enter Username" name="currentUser" required>
	</div>

    <div class="form-group">
		<label><b>Password</b></label>
		<input type="password" class = "form-control" placeholder="Enter Password" name="psw" required>
	</div>
	
    <input type="submit" class="btn btn-primary" value="Login">
  </div>
</form>
</div>

</body>
</html>
