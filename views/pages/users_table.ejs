<!DOCTYPE html>
<html>
<head>
  <title>Users Table</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> 
  <script src="/bootstrap-confirmation.js"></script>
  <script src="/views/functions/cookie.js"></script>
</head>
<body>
    
    <!-- top of the page, bootstrap navigation bar -->
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/">First Aid Bracelet</a>
	            <a class="navbar-brand" href="/admin_main">User</a>
            </div>
	        <ul class="nav navbar-nav navbar-right">
		        <li><a href="/logout">Logout</a></li>
	        </ul>
        </div>
    </nav> 

    <center><h1> User Table <br> </h1></center>

    <div class="row">
        <div class="col-md-1"></div> 
        <div class="col-md-10">
            <center>
            <table class="table table-hover">
                    <thead>
                        <tr>
                        <th>User</th>
                        <th>Type</th>
                        <th>Name</th>
                        <th>Number</th>
                        <th>Division</th>
                        <th>Connected</th>   
                        </tr>
                    </thead>  
                    <tbody>
                        <% docs.forEach(function(doc) { %>
                        <tr id=<%= doc.user%> >
                            <td><%= doc.user%> </td>
                            <td><%= doc.type%> </td>
                            <td><%= doc.name%> </td>
                            <td><%= doc.number%> </td>
                            <td><%= doc.division%> </td>
                            <td><%= doc.status%> </td>
                            <td><form name="Delete_item">
                      	    <button class="btn btn-default" data-toggle="confirmation"
                                    id="delete_item_<%= doc.user%>" onclick="deletingItem('<%=doc.equipment_id%>')"> Delete </button>
                            </form></td>
                        </tr>
                        <% }); %>
                    </tbody>          
            </table>
            </center>
        </div>
        <div class="col-md-1"></div>
    </div>

    <script>
        var uname = getCookie("user");
        document.getElementById(uname).className = "success";
        document.getElementById(uname).title = "Current user";
        <% docs.forEach(function(doc) { %>
            var status = <%- JSON.stringify(doc.status)%>;
            if (status == "connected"){
                uname = <%- JSON.stringify(doc.user)%>;
                var udelete = "delete_item_" + uname;
                document.getElementById(udelete).disabled = true;
                document.getElementById(udelete).title = "Cannot delete connected user";
            }
        <% }); %>
    </script>

</body>
</html>